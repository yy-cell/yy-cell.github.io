{"title":"","slug":"配置OSPF动态路由","date":"2019-08-20T09:18:23.000Z","updated":"2019-08-20T09:18:23.239Z","comments":true,"path":"api/articles/配置OSPF动态路由.json","photos":[],"link":"","excerpt":null,"covers":["https://s2.ax1x.com/2019/08/20/mJhDVf.png"],"content":"<hr>\n<h2 id=\"OSPF路由协议（链路状态\"><a href=\"#OSPF路由协议（链路状态\" class=\"headerlink\" title=\"OSPF路由协议（链路状态\"></a>OSPF路由协议（链路状态</h2><p>）<br>工业标准，工作在网络层<br>组播地址：224.0.0.5 224.0.0.6<br>OSPF概述：<br>通过交换Hello数据包来建立邻居关系<br>以传播LSA代替路由表更新<br>      链路：路由器接口<br>      状态：描述接口以及他与邻居路由器的关系<br>  将LSA    泛洪到所有区域的OSPF路由器，而不是单独的一个<br>  分为三张表：<br>            邻居表<br>            数据库<br>            路由表<br>OSPF分层路由：基于端口划分区域<br>主干路由器（BR）<br>区域边界路由器（ABR）<br>自治系统边界路由器（ASBR）<br>划分区域的好处：<br>减少路由表的路由条目<br>拓扑发生改变时，只影响本区域的数据库<br>每个30分钟泛数据库信息（周期与触发更新）只在本区域泛洪<br>使用OSPF配置负载均衡：<br>默认情况下，最多可在路由表中加入四条等价路径：<br>     可以最多配置16条路径<br>    (config-router)# maximum-paths<value><br>    可以更改特殊链路的开销以确保路径等价于负载均衡：<br>    (config-if)#ip ospf cost <vlaue><br>配置身份认证：<br>   （1）配置明文认证<br>        R1(config-if)#ip ospf authentication-key ccie   设置明文密码，两端口密码要一致<br>        R1(config-if)#ip ospf authentication     开启认证<br>   （2）配置密码认证<br>        R1(config-if)#ip ospf message-digest-key 1 md5 ccie<br>        R1(config-if)#ip ospf authentication<br>   （3）配置区域认证<br>        R1(config-if)#ip ospf message-digest-key 1 md5 ccie<br>        R1(config-router)#area 1 authentication message-digest<br>        区域明文认证<br>        R1(config-if)#ip ospf authentication-key ccie<br>        R1(config-router)#area 1 authentication<br>查看是否配置ospf:sh ip protocols<br>查看邻居表：sh ip ospf neighbor<br>查看链路状态数据库（拓朴表）：sh ip ospf database<br>查看路由表：sh ip route /sh ip route ospf<br>查看ospf进程及相关信息：sh ip ospf<br>查看运行ospf接口的信息：sh ip ospf interface f0/0<br>路由汇总：<br>R2(config-router)#area 1 range 172.16.0.0 255.255.255.252<br>路由重分配<br>R3(config)#router ospf 1<br>R3(config-router)#redistribute eigrp 1 subnets 默认为 metric-type 2  OE2,Metric为20，不累加<br>R3(config-router)#redistribute eigrp 1 metric-type 1 metric 100 subnets  metric-type 1  OE1<br>R3(config)#router eigrp 1<br>R3(config-router)#redistri bute ospf 1 metric 1000 100 255 1 1500（带宽 延迟 可靠性 负载 MTU（最大传输单元））<br>配置外部自治系统路由汇总<br>R3(config)#router ospf 1<br>R3(config-router)#summary-address 192.168.0.0 255.255.252.0<br>在R2上看路由表，会发现有一条路由为：<br>172.16.0.0/22 is a summary, 00:12:06, Null0<br>为避免一路，请使用以下命令：<br>R2(config-router)#no discard-route<br>OSPF的路由类型：<br>O    ：域内路由<br>O/A  ；域间路由<br>OE1  :域外路由  会累加METRIC值<br>OE2  :域外路由，不累加METRIC值默认20，由外部重分布进来默认使用OE2</vlaue></value></p>\n<p>最短路径优先算法（SPF Calculation）<br>Cost=108/BW（b/s)<br>metric值=所有目的地址到达本地路由器的入接口的cost值之和<br>metric值=所有本地路由器到达目的地址的路由器的出接口的cost值之和<br>也可以使用命令sh ip ospf interface loopback 0 查看接口的cost值 </p>\n<p><img src=\"https://s2.ax1x.com/2019/08/20/mJhDVf.png\" alt></p>\n","categories":[],"tags":[]}